import{S as ee,P as te,a as ne,M as oe,D as G,b as ie,c as E,d as b,B as se,T as V,V as a,e as re,Q as ae,f as ce,W as le,F as de,C as pe,g as we,s as fe,h as ue,i as me,j as ye,k as he,l as _,m as C,n as z,o as ge,p as Ee,q as xe,r as Me,t as Ce}from"./vendor.dc8a65a5.js";const ve=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}};ve();const B=new ee,H=new te(14737632);H.position.set(50,20,100);B.add(H);new ne(H);const x=new oe({side:G});new ie({color:16737095,side:G});const F=100,D=100*window.innerWidth/window.innerHeight,Le=new a(-D/2,-F/2,0),be=new a(D/2,-F/2,0),ze=new a(-D/2,F/2,0);Fe(B,D,F);function Fe(o,i,n,r=500){const e=new E(new b(r,n),x);e.rotateY(Math.PI/2),e.position.x=-i/2,e.position.z=-r/2;const t=new E(new b(r,n),x);t.rotateY(Math.PI/2),t.position.x=i/2,t.position.z=-r/2;const c=new E(new b(i,r),x);c.rotateX(Math.PI/2),c.position.z=-r/2,c.position.y=n/2;const u=new E(new b(i,r),x);u.rotateX(Math.PI/2),u.position.z=-r/2,u.position.y=-n/2;const y=new E(new b(i,n),x);y.rotateY(Math.PI),y.position.z=-r;const l=n/4,h=new E(new se(i/3,l,i/5),x);h.position.z=-i/4,h.position.y=-n/2+l/2;const m=new E(new V(8,6,16,100),x);m.rotation.x=3.1415/2,m.position.y=-F/2+l+6,m.position.z=-i/4;for(let g=0;g<100;g++){let p=new E(new V(8,6,16,100),x);p.rotation.x=3.1415/2,p.position.x=(2*Math.random()-1)*i/2,p.position.y=(2*Math.random()-1)*n/2,p.position.z=(2*Math.random()-.5)*200,o.add(p)}o.add(e,t,c,u,y),o.add(h,m)}const $=new a,Y=new a,X=new a,R=new a,P=new a,N=new a,W=new a,j=new ae;function $e(o,i,n,r,e=!1){const t=i,c=n,u=r,y=o.position,l=o.near,h=o.far;R.copy(c).sub(t).normalize(),P.copy(u).sub(t).normalize(),N.crossVectors(R,P).normalize(),$.copy(t).sub(y),Y.copy(c).sub(y),X.copy(u).sub(y);const m=-$.dot(N),g=R.dot($)*l/m,p=R.dot(Y)*l/m,M=P.dot($)*l/m,v=P.dot(X)*l/m;j.setFromUnitVectors(W.set(0,1,0),P),o.quaternion.setFromUnitVectors(W.set(0,0,1).applyQuaternion(j),N).multiply(j),o.projectionMatrix.set(2*l/(p-g),0,(p+g)/(p-g),0,0,2*l/(v-M),(v+M)/(v-M),0,0,0,(h+l)/(l-h),2*h*l/(l-h),0,0,-1,0),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),e&&(o.fov=re.RAD2DEG/Math.min(1,o.aspect)*Math.atan((W.copy(c).sub(t).length()+W.copy(u).sub(t).length())/$.length()))}const Pe=54,f=new ce(Pe,window.innerWidth/window.innerHeight,.1,1e3);f.position.set(0,0,100);const k=new le({canvas:document.querySelector("#world")});k.setPixelRatio(window.devicePixelRatio);k.setSize(window.innerWidth,window.innerHeight);const ke=new de(f,k.domElement),Se=new pe;window.addEventListener("resize",Ie);function Ie(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),k.setSize(window.innerWidth,window.innerHeight)}function Ue(o){const i=Math.min(.05,Se.getDelta())*100;ke.update(i);const n=o;f.translateX(n.x),f.translateY(n.y),f.translateZ(n.z),$e(f,Le,be,ze),k.render(B,f),f.translateX(-n.x),f.translateY(-n.y),f.translateZ(-n.z)}_e([{client:"Chrome"}]);function _e(o){const n=new we().parse(navigator.userAgent);if(n.client===null||n.os===null){alert("Could not detect browser and/or os, continue at your own risk.");return}let r=!1;for(const e of o)if(!(e.client!==void 0&&!new RegExp(`^${e.client}$`).test(n.client.name))&&!(e.os!==void 0&&!new RegExp(`^${e.os}$`).test(n.os.name))){r=!0;break}r||alert(`This demo, running on ${n.client.name}/${n.os.name}, is not well supported at this time, continue at your own risk.`)}const S={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425],centerLine:[10,151,9,8,168,6,197,195,5,4,1,19,94,2,164,0,11,13,14,15,16,17,18,200,199,175,152]},O=1280,Q=720,De={locateFile:o=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${o}`},A=document.getElementsByClassName("input_video")[0],I=document.getElementsByClassName("output_canvas")[0],Re=document.getElementsByClassName("control-panel")[0],We=document.getElementById("info"),d=I.getContext("2d"),Z={selfieMode:!0,enableFaceGeometry:!1,maxNumFaces:1,refineLandmarks:!1,minDetectionConfidence:.5,minTrackingConfidence:.5,intensity:1,color:16777215},K=document.querySelector(".loading");K.ontransitionend=()=>{K.style.display="none"};function Oe(o){document.body.classList.add("loaded"),d.save(),d.clearRect(0,0,I.width,I.height),d.drawImage(o.image,0,0,I.width,I.height);const i=S.rightEyeUpper0.concat(S.rightEyeLower0),n=S.leftEyeUpper0.concat(S.leftEyeLower0),r=S.centerLine;if(o.multiFaceLandmarks.length>0){const e=o.multiFaceLandmarks[0];C(d,i.map(s=>e[s]),{color:"red",radius:5}),C(d,n.map(s=>e[s]),{color:"green",radius:5}),C(d,r.map(s=>e[s]),{color:"orange",radius:5}),z(d,e,ge,{color:"#C0C0C070",lineWidth:1}),z(d,e,Ee,{color:"#E0E0E0"}),z(d,e,xe,{color:"#E0E0E0"}),Z.refineLandmarks&&(z(d,e,Me,{color:"#FF3030"}),z(d,e,Ce,{color:"#30FF30"}));let t=new a(0,0,0);for(const s of e)t.add(new a(s.x,s.y,s.z));t.divideScalar(e.length);const c=s=>s.map(w=>new a(e[w].x,e[w].y,e[w].z)).reduce((w,L)=>w.add(L)).divideScalar(s.length),u=c(i),y=c(n),h=((s,w)=>Math.hypot(Math.abs(s.x-w.x)*O,Math.abs(s.y-w.y)*Q))(y,u);C(d,[u,y],{color:"purple",radius:5}),C(d,[new a(.45,.5,0),new a(.45+100/O,.5,0)],{color:"yellow",radius:5});const m=Math.min(...e.map(s=>s.z)),g=e.map(s=>s.z).indexOf(m);C(d,[e[g]],{color:"red",radius:5});const p=(s,w,L,T)=>Math.atan2(T-w,L-s),M=(s,w,L,T)=>p(s,w,L,T)*(180/Math.PI);M(e[33].x,e[33].y,e[263].x,e[263].y),M(e[33].x,e[33].z,e[263].x,e[263].z);const v=p(e[33].x,e[33].z,e[263].x,e[263].z);M(e[10].y,e[10].z,e[152].y,e[152].z);const J=h/O/Math.cos(v),U=new a((t.x-.5)*100,-(t.y-.5)*100,1/J*10);Ue(U),We.textContent=`final = ${t.x.toFixed(2)},${t.y.toFixed(2)},${t.z.toFixed(2)}, finalCM = ${U.x.toFixed(2)},${U.y.toFixed(2)},${U.z.toFixed(2)}`}d.restore()}const q=new fe(De);q.onResults(Oe);const Te=new ue(A,{onFrame:async()=>{await q.send({image:A}).catch(o=>alert(o))},width:O,height:Q});Te.start();new me(Re,Z).add([new ye({title:"MediaPipe Face Mesh"}),new he({title:"Selfie Mode",field:"selfieMode"}),new _({title:"Min Detection Confidence",field:"minDetectionConfidence",range:[0,1],step:.01}),new _({title:"Min Tracking Confidence",field:"minTrackingConfidence",range:[0,1],step:.01}),new _({title:"light intensity",field:"intensity",range:[-1,6],step:.01}),new _({title:"light color",field:"color",range:[0,16777215],step:1})]).on(o=>{const i=o;A.classList.toggle("selfie",i.selfieMode),q.setOptions(i)});
